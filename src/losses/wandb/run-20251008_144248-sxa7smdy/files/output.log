2025-10-08 14:43:14 - ERROR - An unexpected error occurred: Deterministic behavior was enabled with either `torch.use_deterministic_algorithms(True)` or `at::Context::setDeterministicAlgorithms(true)`, but this operation is not deterministic because it uses CuBLAS and you have CUDA >= 10.2. To enable deterministic behavior in this case, you must set an environment variable before running your PyTorch application: CUBLAS_WORKSPACE_CONFIG=:4096:8 or CUBLAS_WORKSPACE_CONFIG=:16:8. For more information, go to https://docs.nvidia.com/cuda/cublas/index.html#results-reproducibility
Traceback (most recent call last):
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-sr/src/losses/train.py", line 236, in <module>
    fit_nn(model,runname,criterion,Xtrain,ytrain,Xvalid,yvalid)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-sr/src/losses/train.py", line 175, in fit_nn
    ybatchpred = model(Xbatch)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-sr/src/losses/models.py", line 58, in forward
    return self.layers(X)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-sr/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: Deterministic behavior was enabled with either `torch.use_deterministic_algorithms(True)` or `at::Context::setDeterministicAlgorithms(true)`, but this operation is not deterministic because it uses CuBLAS and you have CUDA >= 10.2. To enable deterministic behavior in this case, you must set an environment variable before running your PyTorch application: CUBLAS_WORKSPACE_CONFIG=:4096:8 or CUBLAS_WORKSPACE_CONFIG=:16:8. For more information, go to https://docs.nvidia.com/cuda/cublas/index.html#results-reproducibility
